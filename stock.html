<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>School Inventory System</title>
    <style>
        body {
            background-color: skyblue;
            text-align: center;
        }
        table {
            margin: auto;
            border-collapse: collapse;
        }
        th, td {
            padding: 8px;
            border: 1px solid black;
        }
    </style>
</head>
<body>
    <h1>School Inventory System</h1>
    <img src="applogo.png" alt="App Logo">
    <br><br>

    <div>
        <label for="product">Product:</label>
        <select id="product">
            <option value="uniform">Uniform</option>
            <option value="belt">Belt</option>
            <option value="shoe">Shoe</option>
            <!-- Add other product options here -->
        </select>
        <label for="size">Size:</label>
        <input type="text" id="size">
        <label for="section">Section:</label>
        <input type="text" id="section">
        <label for="totalQuantity">Total Quantity:</label>
        <input type="number" id="totalQuantity">
        <button onclick="addProduct()">Add Product</button>
    </div>
    <br>

    <table id="inventoryTable">
        <thead>
            <tr>
                <th>Product</th>
                <th>Size</th>
                <th>Section</th>
                <th>Total Quantity</th>
                <th>Remaining Quantity</th>
            </tr>
        </thead>
        <tbody>
            <!-- Inventory data will be displayed here -->
        </tbody>
    </table>

    <button onclick="saveToGoogleSheets()">Save to Google Sheets</button>

    <script>
        function addProduct() {
            var product = document.getElementById("product").value;
            var size = document.getElementById("size").value;
            var section = document.getElementById("section").value;
            var totalQuantity = document.getElementById("totalQuantity").value;

            // Calculate remaining quantity
            var remainingQuantity = totalQuantity;

            // Add new row to the table
            var table = document.getElementById("inventoryTable").getElementsByTagName('tbody')[0];
            var newRow = table.insertRow();
            newRow.innerHTML = `<td>${product}</td><td>${size}</td><td>${section}</td><td>${totalQuantity}</td><td>${remainingQuantity}</td>`;
        }

        function saveToGoogleSheets() {
            // Fetch data from table
            var table = document.getElementById("inventoryTable");
            var data = [];
            for (var i = 1; i < table.rows.length; i++) {
                var row = table.rows[i];
                var rowData = [];
                for (var j = 0; j < row.cells.length; j++) {
                    rowData.push(row.cells[j].innerText);
                }
                data.push(rowData);
            }

            // Call Google Apps Script function to save data
            google.script.run.saveDataToGoogleSheets(data);
        }
    </script>
    <script src="https://script.google.com/macros/s/AKfycbxX454JFFDHnJpQ3VM2RDvUeTfuZ5E9gASVVGU61rKTAGXojuEIac8qU3-QF_Fx2NTD4w/exec"></script>
</body>
</html>

